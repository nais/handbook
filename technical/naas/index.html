
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://handbook.nais.io/technical/naas/">
      
      
      <link rel="shortcut icon" href="../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-6.1.7">
    
    
      
        <title>NaaS - NAIS Handbook</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.19753c6b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.196e0c26.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="teal" data-md-color-accent="green">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#what-is-naas-nais-as-a-service" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://handbook.nais.io/" title="NAIS Handbook" class="md-header-nav__button md-logo" aria-label="NAIS Handbook">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            NAIS Handbook
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              NaaS
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/nais/handbook" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
      
      <a href="../.." class="md-tabs__link">
        NAIS Onboarding
      </a>
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
      
      <a href="../../administrative/fixtures/" class="md-tabs__link">
        Administrative
      </a>
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
      
        
      
      <a href="./" class="md-tabs__link md-tabs__link--active">
        Technical
      </a>
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
      
      <a href="../../social/the-great-outdoors/" class="md-tabs__link">
        Social
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://handbook.nais.io/" title="NAIS Handbook" class="md-nav__button md-logo" aria-label="NAIS Handbook">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    NAIS Handbook
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/nais/handbook" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" >
    <label class="md-nav__link" for="nav-1">
      NAIS Onboarding
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="NAIS Onboarding" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        NAIS Onboarding
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Welcome
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../welcome/nais-sponsor/" class="md-nav__link">
      Sponsor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../welcome/nais-manifest-eng/" class="md-nav__link">
      Manifest
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    <label class="md-nav__link" for="nav-2">
      Administrative
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Administrative" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Administrative
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../administrative/fixtures/" class="md-nav__link">
      Fixtures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../administrative/pigs/" class="md-nav__link">
      PIGs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../administrative/slack/" class="md-nav__link">
      Slack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../administrative/trello/" class="md-nav__link">
      Trello
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    <label class="md-nav__link" for="nav-3">
      Technical
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Technical" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Technical
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        NaaS
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      NaaS
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-architecture-overview" class="md-nav__link">
    An architecture overview
  </a>
  
    <nav class="md-nav" aria-label="An architecture overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-nais-io-gcp-organization" class="md-nav__link">
    The nais-io GCP organization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tenant-gcp-organization" class="md-nav__link">
    Tenant GCP organization
  </a>
  
    <nav class="md-nav" aria-label="Tenant GCP organization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-nais-management-gcp-project" class="md-nav__link">
    The nais-management GCP project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tenant-environment-gcp-projects" class="md-nav__link">
    Tenant environment GCP projects
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#administration-and-authorization" class="md-nav__link">
    Administration and authorization
  </a>
  
    <nav class="md-nav" aria-label="Administration and authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-administrators" class="md-nav__link">
    Cluster administrators
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-users" class="md-nav__link">
    Cluster users
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#control-plane-and-cluster-configuration" class="md-nav__link">
    Control plane and cluster configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-features" class="md-nav__link">
    Cluster features
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#naisdevice" class="md-nav__link">
    Naisdevice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exposing-applications" class="md-nav__link">
    Exposing applications
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tenant-setup/" class="md-nav__link">
      Tenant setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nais/" class="md-nav__link">
      What is nais?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../production-ready/" class="md-nav__link">
      Production ready?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../naisdevice/" class="md-nav__link">
      naisdevice
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../publications-media/" class="md-nav__link">
      Publications & Media
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    <label class="md-nav__link" for="nav-4">
      Social
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Social" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Social
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../social/the-great-outdoors/" class="md-nav__link">
      The Great Outdoors
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#an-architecture-overview" class="md-nav__link">
    An architecture overview
  </a>
  
    <nav class="md-nav" aria-label="An architecture overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-nais-io-gcp-organization" class="md-nav__link">
    The nais-io GCP organization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tenant-gcp-organization" class="md-nav__link">
    Tenant GCP organization
  </a>
  
    <nav class="md-nav" aria-label="Tenant GCP organization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-nais-management-gcp-project" class="md-nav__link">
    The nais-management GCP project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tenant-environment-gcp-projects" class="md-nav__link">
    Tenant environment GCP projects
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#administration-and-authorization" class="md-nav__link">
    Administration and authorization
  </a>
  
    <nav class="md-nav" aria-label="Administration and authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cluster-administrators" class="md-nav__link">
    Cluster administrators
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster-users" class="md-nav__link">
    Cluster users
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#control-plane-and-cluster-configuration" class="md-nav__link">
    Control plane and cluster configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-features" class="md-nav__link">
    Cluster features
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#naisdevice" class="md-nav__link">
    Naisdevice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exposing-applications" class="md-nav__link">
    Exposing applications
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/nais/handbook/edit/master/docs/technical/naas.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="what-is-naas-nais-as-a-service">What is NaaS (Nais As A Service)?<a class="headerlink" href="#what-is-naas-nais-as-a-service" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>NaaS is a centralized system for governance of NAIS clusters and a uniform way of applying features.
Its purpose is remaining a clear separation between tenants and their configuration, whilst still remaining centralized control.</p>
<h2 id="an-architecture-overview">An architecture overview<a class="headerlink" href="#an-architecture-overview" title="Permanent link">&para;</a></h2>
<h3 id="the-nais-io-gcp-organization">The nais-io GCP organization<a class="headerlink" href="#the-nais-io-gcp-organization" title="Permanent link">&para;</a></h3>
<p><span style="display:flex">
<img src="/assets/naas-nais-io-org.png" width="350" style="margin-right:20px"/>
<span>
We want a clear separation between the administration of the clusters and the clusters themselves. 
The <code>nais-io</code> GCP organization serves this purpose; this is where administrative users, configuration and control-plane components reside.
</span>
</span></p>
<blockquote>
<p><a href="https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy#organizations">What is a GCP organization?</a></p>
</blockquote>
<h3 id="tenant-gcp-organization">Tenant GCP organization<a class="headerlink" href="#tenant-gcp-organization" title="Permanent link">&para;</a></h3>
<p>Each tenant has its own separate GCP organization.
As with the nais-io GCP organization, we want a clear separation between administration and workloads.
<img alt="" src="/assets/naas-partner-org.png" /></p>
<h4 id="the-nais-management-gcp-project">The nais-management GCP project<a class="headerlink" href="#the-nais-management-gcp-project" title="Permanent link">&para;</a></h4>
<p>To achieve this, all tenant wide services (eg. deploy, tenant console, etc.) run in a separate GCP project called nais-management.
This GCP project is fully managed and owned by the NAIS team.</p>
<h4 id="tenant-environment-gcp-projects">Tenant environment GCP projects<a class="headerlink" href="#tenant-environment-gcp-projects" title="Permanent link">&para;</a></h4>
<p>The tenant will have multiple clusters, typically dev and prod, and each of these clusters require a suite of NAIS components (eg. naiserator, monitoring, etc.).
To separate NAIS components and from tenant workloads, each cluster has a nais-system namespace, where all NAIS-related services reside.
All tenant workloads will run in separate team namespaces in this cluster.</p>
<blockquote>
<p><a href="https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy#projects"> What is a GCP project?</a></p>
</blockquote>
<h2 id="administration-and-authorization">Administration and authorization<a class="headerlink" href="#administration-and-authorization" title="Permanent link">&para;</a></h2>
<h3 id="cluster-administrators">Cluster administrators<a class="headerlink" href="#cluster-administrators" title="Permanent link">&para;</a></h3>
<p>NAIS personnel has an <code>@nais.io</code> user, who initially has no permissions outside of the <code>nais-io</code> GCP organization.
There is an administration group in the <code>nais-io</code> GCP organization that is granted access to the respective tenant's GCP organization.
This groups is normally empty, but when there is a demand, NAIS operators can grant themselves just in time access by adding their user to this group, and thus access to the tenant.
<img alt="" src="/assets/naas-admin-groups.png" /></p>
<blockquote>
<p><strong>Example:</strong> The group <code>nav-k8s-admins@nais.io</code> is granted administrative rights in NAV tenant GCP organization.</p>
</blockquote>
<h3 id="cluster-users">Cluster users<a class="headerlink" href="#cluster-users" title="Permanent link">&para;</a></h3>
<p>The tenant is responsible for populating their GCP organization with users.
This is typically done by synchronizing users from their IDP.
Additionally we recommend configuring an IDP, so the tenant remains in control of the authorization flow.
<img alt="" src="/assets/naas-user-admin.png" /></p>
<blockquote>
<p><strong>Example:</strong> Nav synchronize their users from Azure AD and configure Azure AD to be the IDP.</p>
</blockquote>
<p>Each tenant has their own <code>console</code> where they can manage users, features and access for each of their teams.
When a user is allocated to a team, access to resources are granted according to what is configured by the tenant in their console.</p>
<h2 id="control-plane-and-cluster-configuration">Control plane and cluster configuration<a class="headerlink" href="#control-plane-and-cluster-configuration" title="Permanent link">&para;</a></h2>
<p>The NAIS control plane consist of two primary components, <code>Fasit</code> and <code>naisd</code>.
<code>Fasit</code> is the primary configuration database for all clusters.
It runs in the <code>nais-io</code> cluster in the <code>nais-io</code> GCP organization.
<code>Naisd</code> is a component that runs in each cluster and is responsible for applying and installing components.
When a configuration is ready to be applied to a cluster, <code>Fasit</code> publish a message to a pub/sub-topic specific to the relevant cluster.
<code>Naisd</code> picks up the message and applies the configuration.
When the configuration is applied, <code>naisd</code> sends a status message on a central status topic.
<code>Fasit</code> reads all statuses from all clusters and use this information to give a complete overview of the entire ecosystem.
<img alt="" src="/assets/naas-control-plane.png" /></p>
<h2 id="cluster-features">Cluster features<a class="headerlink" href="#cluster-features" title="Permanent link">&para;</a></h2>
<p>All of the components that are available for deployment in a cluster are wrapped in helm-charts.
Each component has a github workflow that builds the helm-chart (and if applicable a docker image).
The workflow publish each of these artifacts to an artifact registry in the nais-io GCP organization (using workload identity).</p>
<p>The chart will normally contain sane defaults for the component, but can be overridden in Fasit on a per cluster basis.
The component definition in fasit also caters for dependencies between features.</p>
<blockquote>
<p><strong>Example:</strong> naiserator depends on the nais-crds availability in the cluster in order to work.</p>
</blockquote>
<h2 id="naisdevice">Naisdevice<a class="headerlink" href="#naisdevice" title="Permanent link">&para;</a></h2>
<p>Every cluster is a private cluster using only private IP-addresses with no direct exposure to the public.
In order to reach a cluster, a user is required to run <code>naisdevice</code>, which sets up a VPN tunnel to a <code>naisdevice gateway</code> in the relevant cluster.
<img alt="" src="/assets/naas-naisdevice.png" />
Anyone who require access to the clusters will have to install <code>naisdevice</code> on their computer.
Based on the domain provided in the user's authorization token, the authentication server will grant access to the relevant clusters.</p>
<h2 id="exposing-applications">Exposing applications<a class="headerlink" href="#exposing-applications" title="Permanent link">&para;</a></h2>
<p><span style="display:flex">
<img src="/assets/naas-loadbalancing.png" width="350" style="margin-right:20px"/>
<span>
Each cluster has a single load balancer and a single set of ingress controllers.
Access to each domain on this load balancer is goverened by cloud armor policies.
The tenant can restrict which clients can access a domain by defining cloud armor policies. <br/></p>
<blockquote>
<p><strong>Example:</strong> app-a.x.com can be exposed globally, whilst app-b.y.com is restricted to a predefined set of source IPs.</p>
</blockquote>
<p>The load balancer will terminate SSL using certificates provided by the tenant.
</span>
</span></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../administrative/trello/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Trello
              </div>
            </div>
          </a>
        
        
          <a href="../tenant-setup/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Tenant setup
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.0ac82a11.min.js"></script>
      <script src="../../assets/javascripts/bundle.f81dfb4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['navigation.instant', 'navigation.tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../amplitude_javascript/events.js"></script>
      
    
  </body>
</html>