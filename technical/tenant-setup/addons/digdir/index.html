
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://handbook.nais.io/technical/tenant-setup/addons/digdir/">
      
      
        <link rel="prev" href="../azure-ad/">
      
      
        <link rel="next" href="../domains/">
      
      
      <link rel="icon" href="../../../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Digdirator - NAIS Handbook</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../css/timeago.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#digdirator" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="NAIS Handbook" class="md-header__button md-logo" aria-label="NAIS Handbook" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NAIS Handbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Digdirator
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/nais/handbook" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="NAIS Handbook" class="md-nav__button md-logo" aria-label="NAIS Handbook" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    NAIS Handbook
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nais/handbook" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A handbook of sorts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Daily workflows
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Daily workflows
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../daily-workflows/tenant-switching-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Typical workflow examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../nais-system/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Nais system
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Nais system
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../nais-system/ambitions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ambitions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../nais-system/areas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NAIS areas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../nais-system/board/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Nais board
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../nais-system/cycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A NAIS cycle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../nais-system/holiday-mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Holiday modes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../nais-system/initiatives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Initiative
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../nais-system/minitiative/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Minitiatives
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../nais-system/nais-day/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    A NAIS day
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../nais-system/properties/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties of Nais
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Technical
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Technical
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../announcements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Announcements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../doc-guidelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NAIS documentation guidelines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../external-ingress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    External ingress
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../nais-alerts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nais alerts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../naisdevice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Naisdevice (Nav)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../observability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Observability Stack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NAIS Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../postgres/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Postgres in nais-system
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../privileges/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Privilegier og brukere
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../production-ready/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is production ready?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../publications-media/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Publications &amp; Media
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../upgrading-kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Procedure to follow when upgrading Kafka
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../iam/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Identity and Access Management
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            Identity and Access Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../narcos/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    narcos
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            narcos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14_2" >
        
          
          <label class="md-nav__link" for="__nav_4_14_2" id="__nav_4_14_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    📚 Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_14_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14_2">
            <span class="md-nav__icon md-icon"></span>
            📚 Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../narcos/reference/kubeconfig/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    kubeconfig command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../narcos/reference/tenant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tenant command
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_15" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tenant setup
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_15" id="__nav_4_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_15_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_15">
            <span class="md-nav__icon md-icon"></span>
            Tenant setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1-nais/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Step 1 - Nais-team preparations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2-tenant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Step 2 - Tenant preparations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3-nais-terraform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Step 3 - Nais terraforming the tenant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4-nais/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Step 4 - Nais post terraforming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5-tenant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Step 5 - Tenant post terraforming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_15_7" checked>
        
          
          <label class="md-nav__link" for="__nav_4_15_7" id="__nav_4_15_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Addons
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_15_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_15_7">
            <span class="md-nav__icon md-icon"></span>
            Addons
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aiven/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aiven services and Kafka
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../azure-ad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Azure AD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Digdirator
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Digdirator
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#for-tenant" class="md-nav__link">
    <span class="md-ellipsis">
      For Tenant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="For Tenant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digdir-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Digdir configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Digdir configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-administration-clients-for-id-porten-maskinporten" class="md-nav__link">
    <span class="md-ellipsis">
      Configure administration clients for ID-porten &amp; Maskinporten
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nais-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      NAIS configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NAIS configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#business-certificate" class="md-nav__link">
    <span class="md-ellipsis">
      Business certificate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate chain
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Certificate chain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-format-of-a-certificate-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Example format of a certificate chain
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#for-nais" class="md-nav__link">
    <span class="md-ellipsis">
      For NAIS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-nais-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of NAIS configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      Import Certificates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Import Certificates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pre-requisites" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-requisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pre-requisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#google-cloud-kms" class="md-nav__link">
    <span class="md-ellipsis">
      Google Cloud KMS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#google-secret-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Google Secret Manager
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../domains/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Domains
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tokenx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TokenX
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wonderwall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wonderwall
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Welcome
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../welcome/nais-manifest-eng/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NAIS is a AAAA rated platform service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../welcome/nais-sponsor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NAIS-Sponsor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#for-tenant" class="md-nav__link">
    <span class="md-ellipsis">
      For Tenant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="For Tenant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digdir-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Digdir configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Digdir configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-administration-clients-for-id-porten-maskinporten" class="md-nav__link">
    <span class="md-ellipsis">
      Configure administration clients for ID-porten &amp; Maskinporten
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nais-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      NAIS configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NAIS configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#business-certificate" class="md-nav__link">
    <span class="md-ellipsis">
      Business certificate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate chain
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Certificate chain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-format-of-a-certificate-chain" class="md-nav__link">
    <span class="md-ellipsis">
      Example format of a certificate chain
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#for-nais" class="md-nav__link">
    <span class="md-ellipsis">
      For NAIS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-nais-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of NAIS configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      Import Certificates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Import Certificates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pre-requisites" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-requisites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pre-requisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#google-cloud-kms" class="md-nav__link">
    <span class="md-ellipsis">
      Google Cloud KMS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#google-secret-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Google Secret Manager
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/nais/handbook/edit/main/docs/technical/tenant-setup/addons/digdir.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="digdirator">Digdirator<a class="headerlink" href="#digdirator" title="Permanent link">&para;</a></h1>
<div class="admonition info">
<p class="admonition-title">Digdirator enabled</p>
<p>This is an optional addon in NaaS. It is not enabled by default.</p>
</div>
<p><a href="https://github.com/nais/digdirator">Digdirator</a> is a feature that integrates with Digdir self-service API. Digdirator
enables automated registration and lifecycle management of ID-porten and Maskinporten clients.</p>
<p>Before Digdirator can use the self-service API, the tenant must receive administration clients from Digdir,
one for each client type, Maskinporten and ID-porten.
The Digdir self-service API is secured with oAuth2 using a <code>business certificate</code>.</p>
<p>An overview of the setup is as follows:</p>
<ul>
<li>Clients exist in Digdir and a <code>business certificate</code> is configured</li>
<li>Clients are configured with <a href="#digdir-configuration">scopes</a> required</li>
<li>Add Client ID's to Secret Manager in your project</li>
<li>Add <code>business certificate</code> to Google Key Management Service in your project</li>
<li>Add business certificate <code>certificate-chain</code> to Secret Manager in your project</li>
</ul>
<h2 id="for-tenant">For Tenant<a class="headerlink" href="#for-tenant" title="Permanent link">&para;</a></h2>
<h3 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h3>
<h4 id="digdir-configuration">Digdir configuration<a class="headerlink" href="#digdir-configuration" title="Permanent link">&para;</a></h4>
<details class="info">
<summary>Recommended configuration for administration clients</summary>
<p>To secure the integration with Digdir we recommend using a separate certificate for each registered client and that tenants request Digdir to lock each
certificate to each client. If you already have a certificate for your clients, you can use that. As setup with these kinds of certificates
is not part of this guide, we recommend that you contact Digdir for assistance.</p>
</details>
<h5 id="configure-administration-clients-for-id-porten-maskinporten">Configure administration clients for ID-porten &amp; Maskinporten<a class="headerlink" href="#configure-administration-clients-for-id-porten-maskinporten" title="Permanent link">&para;</a></h5>
<ul>
<li>ID-porten client is configured with scopes: <code>idporten:dcr.write idporten:dcr.read</code></li>
<li>Maskinporten client is configured with scopes: <code>idporten:dcr.write idporten:dcr.read idporten:scopes.write</code></li>
<li><code>business certificates</code> are registered in Digdir</li>
</ul>
<div class="admonition success">
<p class="admonition-title">Tenant imports the Client ID's to <a href="#google-secret-manager">Secret Manager</a> and provide the resource names to NAIS</p>
<p><code>projects/&lt;project-id&gt;/secrets/&lt;secret-id&gt;/versions/&lt;version&gt;</code></p>
</div>
<details class="info">
<summary>Digdirator use of Client ID</summary>
<p>Digdirator sets the Client ID as the claim <code>iss</code> when authenticating against Digdir self-service API</p>
</details>
<h4 id="nais-configuration">NAIS configuration<a class="headerlink" href="#nais-configuration" title="Permanent link">&para;</a></h4>
<p>We really care about our compadres (tenants) and we think that a separation of concerns is a good &amp; secure way to
go.
It also helps us to keep the cluster secure and stable. The configuration setup for Digdirator favor security as
NAIS never have direct access to your business certificate.</p>
<p>When setup in Digdir is confirmed by tenant and before we can enable Digdirator, the following steps must be completed:</p>
<h5 id="business-certificate">Business certificate<a class="headerlink" href="#business-certificate" title="Permanent link">&para;</a></h5>
<details class="info">
<summary>Update existing certificate</summary>
<p>Update of a certificate only requires the tenant to provide NAIS with the new <code>&lt;version&gt;</code></p>
</details>
<p>The tenant upload their <code>business certificate</code> to
<a href="https://cloud.google.com/kms/docs/how-tos">Google Cloud KMS</a>. Digdirator will never have direct access to the certificate.
Once it is uploaded the business certificate can only be used for cryptographic operations.
The business certificate can never be downloaded or retrieved from the KMS storage.</p>
<p>An authenticated &amp; authorized Digdirator can only request the <code>Google KMS</code> to sign a payload containing an unsigned
token with claims, if successful the KMS returns a signed JWT, this JWT is later used to authenticate against Digdir self-service
API.</p>
<div class="admonition success">
<p class="admonition-title">Certificate is <a href="#import-certificates">successfully uploaded</a> to Google KMS, provide NAIS with the resource names</p>
<p><code>projects/&lt;project-id&gt;/locations/&lt;location&gt;/keyRings/&lt;keyring&gt;/cryptoKeys/&lt;key&gt;/cryptoKeyVersions/&lt;version&gt;</code></p>
</div>
<h5 id="certificate-chain">Certificate chain<a class="headerlink" href="#certificate-chain" title="Permanent link">&para;</a></h5>
<details class="info">
<summary>Update existing certificate chain</summary>
<p>This information unlikely to change, only if a new certificate type is added to the Google KMS.
Then the tenant must provide the new resource name or <code>&lt;version&gt;</code> of the certificate chain.</p>
</details>
<p>Now your probably are wondering why another secret storage we already configured KMS?</p>
<p>Well, when authenticating using a <code>buissness certificate</code> the oauth2.0 spec recommends the <code>certificate chain</code> to be
present in the token header.</p>
<p>The public <code>certificate chain</code> should be set to the <code>x5c</code> (X.509 certificate chain) header parameter, corresponding to
the key used to digitally sign the JWS (JSON Web Signature).</p>
<p><code>Google Cloud Key Mangement Service</code> is designed as a cryptographic system: nobody, including yourself, can get the keys
out: this means they're locked inside the system, and you don't have to worry in practice about them leaking.
The tradeoff is that the only thing you can do with those keys is encrypting, decrypt, and other cryptographic
operations.</p>
<p>But when you do have configuration info like a certificate chain or a client-id, where your software actually needs the
secret, not cryptographic operations, then <code>Secret Manager</code> is designed for that use case.</p>
<div class="admonition success">
<p class="admonition-title">Certificate chains is <a href="#import-certificates">successfully uploaded</a> to <code>Secret Manager</code>, provide NAIS with the resource names</p>
<p><code>projects/&lt;project-id&gt;/secrets/&lt;secret-id&gt;/versions/&lt;version&gt;</code></p>
</div>
<h6 id="example-format-of-a-certificate-chain">Example format of a certificate chain<a class="headerlink" href="#example-format-of-a-certificate-chain" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>-----BEGIN CERTIFICATE-----
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>MIIFCDECEBC...
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>-----END CERTIFICATE-----
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>-----BEGIN CERTIFICATE-----
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>MIIE3sKEA...
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>-----END CERTIFICATE-----
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>-----BEGIN CERTIFICATE-----
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>MIIFZTKK...
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>-----END CERTIFICATE-----
</code></pre></div>
<h2 id="for-nais">For NAIS<a class="headerlink" href="#for-nais" title="Permanent link">&para;</a></h2>
<p>When Digdirator is enabled, NAIS configures Digdirator with a service account which holds a set of roles to access Google Cloud KMS and Secret Manager in your
cluster project.</p>
<p>To access <code>Google KMS</code> the service account is assigned the IAM role <code>roles/cloudkms.signerVerifier</code>,
which enables sign, verify, and getPublicKey operations.</p>
<details class="info">
<summary>Google Cloud KMS roles</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>cloudkms.cryptoKeyVersions.useToSign
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>cloudkms.cryptoKeyVersions.useToVerify
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>cloudkms.cryptoKeyVersions.viewPublicKey
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>cloudkms.locations.get
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>cloudkms.locations.list
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>resourcemanager.projects.get
</code></pre></div>
</details>
<p>To access <code>Secret Manager</code> the service account is assigned the IAM role <code>roles/secretmanager.secretAccessor</code> which allows Digdirator to
access the payload of secrets.</p>
<details class="info">
<summary>Google Secret Manager roles</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>secretmanager.secrets.get
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>secretmanager.secrets.access
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>resourcemanager.projects.get
</code></pre></div>
</details>
<p>NAIS will configure Digdirator with the information provided, you relax your cognitive load.
Configure your <a href="https://docs.nais.io/nais-application/application/">NAIS application</a> with ID-porten or Maskinporten, push code -&gt; deploy.
NAIS handles the rest.</p>
<div class="admonition warning">
<p class="admonition-title">ID-porten sidecar</p>
<p>If you plan to use the <a href="https://docs.nais.io/security/auth/idporten/sidecar/?h=sidecar">ID-porten sidecar</a>, prior to usage, the feature <a href="https://docs.nais.io/appendix/wonderwall/">Wonderwall</a> must be enabled.
Contact NAIS team for more information.</p>
</div>
<h2 id="summary-of-nais-configuration">Summary of NAIS configuration<a class="headerlink" href="#summary-of-nais-configuration" title="Permanent link">&para;</a></h2>
<p>If we were to translate the above information required by NAIS to configure automated lifecycle of Digdir clients.
Translated to yaml, it would look something like this</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nt">maskinporten</span><span class="p">:</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="nt">kms</span><span class="p">:</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;projects/123456789/locations/europe-north1/keyRings/nais-test/cryptoKeys/maskinporten-cert-chain/cryptoKeyVersions/1&quot;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span><span class="nt">secret-manager</span><span class="p">:</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="nt">client-id</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;projects/123456789/secrets/maskinporten-client-id/versions/1&quot;</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="nt">cert-cain</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;projects/123456789/secrets/maskinporten-cert-chain/versions/1&quot;</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="nt">idporten</span><span class="p">:</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">  </span><span class="nt">kms</span><span class="p">:</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">    </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;projects/123456789/locations/europe-north1/keyRings/nais-test/cryptoKeys/idporten-cert-chain/cryptoKeyVersions/1&quot;</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">  </span><span class="nt">secret-manager</span><span class="p">:</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">    </span><span class="nt">client-id</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;projects/123456789/secrets/idporten-client-id/versions/1&quot;</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">    </span><span class="nt">cert-cain</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;projects/123456789/secrets/idporten-cert-chain/versions/1&quot;</span>
</code></pre></div>
<h2 id="import-certificates">Import Certificates<a class="headerlink" href="#import-certificates" title="Permanent link">&para;</a></h2>
<h3 id="pre-requisites">Pre-requisites<a class="headerlink" href="#pre-requisites" title="Permanent link">&para;</a></h3>
<p><a href="https://cloud.google.com/sdk/docs/install">gcloud</a> CLI is installed and configured with a user that have access to the
project.</p>
<p>Some configuration can be done in the Google Cloud Console, automatic wrap and import must be done with the <code>gcloud</code>
CLI.</p>
<h4 id="google-cloud-kms">Google Cloud KMS<a class="headerlink" href="#google-cloud-kms" title="Permanent link">&para;</a></h4>
<ol>
<li>Create a <a href="https://cloud.google.com/kms/docs/importing-a-key#create_targets">target key and key ring</a> in your project</li>
<li>Create a <a href="https://cloud.google.com/kms/docs/importing-a-key#import_job">import job</a> for the target key.</li>
<li>
<p>Make an import request for <a href="https://cloud.google.com/kms/docs/importing-a-key#request_import">key</a></p>
</li>
<li>
<p>Wrap and import of key can be done in automatically or manually.</p>
<ul>
<li>Automatically <a href="https://cloud.google.com/kms/docs/importing-a-key#automatically_wrap_and_import">wrap and import</a>
  with <code>gcloud</code> CLI</li>
<li>Manually is divided into 2 steps<ul>
<li><a href="https://cloud.google.com/kms/docs/wrapping-a-key">Manually wrap</a> using OpenSSL for Linux or macOS.</li>
<li><a href="https://cloud.google.com/kms/docs/importing-a-key#importing_a_manually-wrapped_key">Manually import</a> in the
  Google
  Cloud Console or gcloud CLI.</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="google-secret-manager">Google Secret Manager<a class="headerlink" href="#google-secret-manager" title="Permanent link">&para;</a></h4>
<ul>
<li>Create a <a href="https://cloud.google.com/secret-manager/docs/creating-and-accessing-secrets#creating_a_secret">secret</a> in
  your project</li>
</ul>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="August 25, 2025 06:40:51 UTC"><span class="timeago" datetime="2025-08-25T06:40:51+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="August 25, 2025 06:40:51 UTC">2025-08-25</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="August 25, 2025 06:40:51 UTC"><span class="timeago" datetime="2025-08-25T06:40:51+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="August 25, 2025 06:40:51 UTC">2025-08-25</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../azure-ad/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Azure AD">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Azure AD
              </div>
            </div>
          </a>
        
        
          
          <a href="../domains/" class="md-footer__link md-footer__link--next" aria-label="Next: Custom Domains">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Custom Domains
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Made with ❤️ by NAV
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/nais" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/nais_io" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/nav" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://nais.io/blog" target="_blank" rel="noopener" title="nais.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M483.1 159.7c10.9-24.6 21.4-60.4 21.4-87.9 0-72.7-79.6-98.4-209.7-38.6C187.2 26 83.6 106.9 57.7 219.7c30.9-34.9 78.3-82.3 122-101.2C125.4 166.8 79.1 227.9 44 291.7c-20.7 37.9-44 99.2-44 145 0 98.6 92.9 86.5 180.3 42 31.4 15.4 66.6 15.6 101.7 15.6 97.1 0 184.2-54.3 216.8-146H378c-52.5 88.6-196.8 53-196.8-47.4H510c6.4-43.6-1.7-95.7-26.9-141.2M64.6 346.9c17.7 51.1 53.7 95.8 100.2 123.3C76.1 519.1-8.4 499.3 64.6 346.9M180.5 238c2-55.2 50.3-94.9 104-94.9 53.4 0 102 39.7 104 94.9zM365.1 50.4c21.4-10.3 48.6-22 72.6-22 31.4 0 54.3 21.7 54.3 53.7 0 20-7.4 49-14.6 67.9-26.3-42.3-66-81.6-112.3-99.6"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.action.edit", "content.code.copy", "content.code.annotate", "content.tabs.link", "navigation.footer", "navigation.instant", "navigation.indexes", "search.suggest"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../../../js/timeago.min.js"></script>
      
        <script src="../../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../../amplitude_javascript/events.js"></script>
      
    
  </body>
</html>